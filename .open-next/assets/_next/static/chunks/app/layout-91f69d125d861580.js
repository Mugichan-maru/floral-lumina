(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},760:(e,t,r)=>{"use strict";r.d(t,{N:()=>g});var s=r(5155),n=r(2115),l=r(869),i=r(2885),a=r(7494),o=r(845),c=r(7351),d=r(1508);class u extends n.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,c.s)(e)&&e.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function f(e){let{children:t,isPresent:r,anchorX:l,root:i}=e,a=(0,n.useId)(),o=(0,n.useRef)(null),c=(0,n.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=(0,n.useContext)(d.Q);return(0,n.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:n,right:d}=c.current;if(r||!o.current||!e||!t)return;o.current.dataset.motionPopId=a;let u=document.createElement("style");f&&(u.nonce=f);let h=null!=i?i:document.head;return h.appendChild(u),u.sheet&&u.sheet.insertRule('\n          [data-motion-pop-id="'.concat(a,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===l?"left: ".concat(n):"right: ".concat(d),"px !important;\n            top: ").concat(s,"px !important;\n          }\n        ")),()=>{h.contains(u)&&h.removeChild(u)}},[r]),(0,s.jsx)(u,{isPresent:r,childRef:o,sizeRef:c,children:n.cloneElement(t,{ref:o})})}let h=e=>{let{children:t,initial:r,isPresent:l,onExitComplete:a,custom:c,presenceAffectsLayout:d,mode:u,anchorX:h,root:m}=e,x=(0,i.M)(p),y=(0,n.useId)(),g=!0,b=(0,n.useMemo)(()=>(g=!1,{id:y,initial:r,isPresent:l,custom:c,onExitComplete:e=>{for(let t of(x.set(e,!0),x.values()))if(!t)return;a&&a()},register:e=>(x.set(e,!1),()=>x.delete(e))}),[l,x,a]);return d&&g&&(b={...b}),(0,n.useMemo)(()=>{x.forEach((e,t)=>x.set(t,!1))},[l]),n.useEffect(()=>{l||x.size||!a||a()},[l]),"popLayout"===u&&(t=(0,s.jsx)(f,{isPresent:l,anchorX:h,root:m,children:t})),(0,s.jsx)(o.t.Provider,{value:b,children:t})};function p(){return new Map}var m=r(2082);let x=e=>e.key||"";function y(e){let t=[];return n.Children.forEach(e,e=>{(0,n.isValidElement)(e)&&t.push(e)}),t}let g=e=>{let{children:t,custom:r,initial:o=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:u="sync",propagate:f=!1,anchorX:p="left",root:g}=e,[b,j]=(0,m.xQ)(f),v=(0,n.useMemo)(()=>y(t),[t]),w=f&&!b?[]:v.map(x),N=(0,n.useRef)(!0),C=(0,n.useRef)(v),k=(0,i.M)(()=>new Map),[_,P]=(0,n.useState)(v),[E,T]=(0,n.useState)(v);(0,a.E)(()=>{N.current=!1,C.current=v;for(let e=0;e<E.length;e++){let t=x(E[e]);w.includes(t)?k.delete(t):!0!==k.get(t)&&k.set(t,!1)}},[E,w.length,w.join("-")]);let R=[];if(v!==_){let e=[...v];for(let t=0;t<E.length;t++){let r=E[t],s=x(r);w.includes(s)||(e.splice(t,0,r),R.push(r))}return"wait"===u&&R.length&&(e=R),T(y(e)),P(v),null}let{forceRender:M}=(0,n.useContext)(l.L);return(0,s.jsx)(s.Fragment,{children:E.map(e=>{let t=x(e),n=(!f||!!b)&&(v===E||w.includes(t));return(0,s.jsx)(h,{isPresent:n,initial:(!N.current||!!o)&&void 0,custom:r,presenceAffectsLayout:d,mode:u,root:g,onExitComplete:n?void 0:()=>{if(!k.has(t))return;k.set(t,!0);let e=!0;k.forEach(t=>{t||(e=!1)}),e&&(null==M||M(),T(C.current),f&&(null==j||j()),c&&c())},anchorX:p,children:e},t)})})}},1493:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.t.bind(r,8110,23)),Promise.resolve().then(r.t.bind(r,3442,23)),Promise.resolve().then(r.bind(r,4409)),Promise.resolve().then(r.bind(r,5323))},3442:e=>{e.exports={style:{fontFamily:"'Noto Sans JP', 'Noto Sans JP Fallback'",fontStyle:"normal"},className:"__className_a70e0e",variable:"__variable_a70e0e"}},4409:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var s=r(5155),n=r(2115),l=r(760),i=r(5206),a=r(5695),o=r(5323),c=r(6766);function d(e){let{item:t}=e,{removeItem:r,updateQuantity:n}=(0,o._)(),l=(e=>{let t=e.match(/[\d,]+/);return t?parseInt(t[0].replace(/,/g,""),10):0})(t.product.price),a=l*t.quantity,d=e=>{e<=0?r(t.id):n(t.id,e)};return(0,s.jsxs)(i.P.div,{className:"flex gap-4 p-4 border-b border-gray-200 last:border-b-0",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:[(0,s.jsx)("div",{className:"w-16 h-20 flex-shrink-0 relative",children:(0,s.jsx)(c.default,{src:t.product.images[0],alt:t.product.title,fill:!0,className:"object-cover rounded-lg"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-sm font-display text-gray-dark truncate mb-1",children:t.product.title}),t.selectedColor&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 font-body mb-2",children:["カラー: ",t.selectedColor]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-sm text-brand-gold font-display font-semibold",children:l>0?"\xa5".concat(a.toLocaleString()):t.product.price}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.P.button,{onClick:()=>d(t.quantity-1),className:"w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center hover:border-brand-gold transition-colors",whileTap:{scale:.9},children:(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,s.jsx)("span",{className:"text-sm font-body min-w-[20px] text-center",children:t.quantity}),(0,s.jsx)(i.P.button,{onClick:()=>d(t.quantity+1),className:"w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center hover:border-brand-gold transition-colors",whileTap:{scale:.9},children:(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),l>0&&t.quantity>1&&(0,s.jsxs)("p",{className:"text-xs text-gray-400 font-body mt-1",children:["単価: \xa5",l.toLocaleString()]})]}),(0,s.jsx)(i.P.button,{onClick:()=>r(t.id),className:"w-6 h-6 text-gray-400 hover:text-red-500 transition-colors flex-shrink-0",whileTap:{scale:.9},children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}function u(){let{state:e,closeCart:t,clearCart:r}=(0,o._)(),c=(0,a.useRouter)(),[u,f]=n.useState(!1),[h,p]=n.useState(null),m=async()=>{try{if(p(null),0===e.items.length)return void t();f(!0),t(),c.push("/checkout")}catch(e){p((null==e?void 0:e.message)||"チェックアウトでエラーが発生しました")}finally{f(!1)}};return(0,s.jsx)(l.N,{children:e.isOpen&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.P.div,{className:"fixed inset-0 bg-black/50 z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e=>{e.target===e.currentTarget&&t()}}),(0,s.jsxs)(i.P.div,{className:"fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-xl z-50 flex flex-col",initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-lg font-display text-gray-800",children:"ショッピングカート"}),(0,s.jsx)(i.P.button,{onClick:t,className:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center transition-colors",whileTap:{scale:.9},children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===e.items.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})})}),(0,s.jsx)("h3",{className:"text-lg font-display text-gray-800 mb-2",children:"カートは空です"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 font-body mb-6",children:["お気に入りの商品を見つけて",(0,s.jsx)("br",{}),"カートに追加してください"]}),(0,s.jsx)(i.P.button,{onClick:t,className:"bg-brand-gold text-white px-6 py-3 rounded-full font-display text-sm tracking-wide hover:bg-opacity-90 transition-colors",whileHover:{y:-2},whileTap:{scale:.98},children:"商品を見る"})]}):(0,s.jsxs)("div",{children:[e.items.length>0&&(0,s.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,s.jsx)(i.P.button,{onClick:r,className:"text-xs text-gray-500 hover:text-red-500 transition-colors font-body",whileTap:{scale:.95},children:"カートを空にする"})}),(0,s.jsx)(l.N,{children:e.items.map(e=>(0,s.jsx)(d,{item:e},e.id))})]})}),e.items.length>0&&(0,s.jsxs)("div",{className:"border-t border-gray-200 p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-lg font-display text-gray-800",children:["合計：",e.totalItems,"点"]}),(0,s.jsxs)("span",{className:"text-lg font-display font-semibold text-brand-gold",children:["\xa5",e.totalPrice.toLocaleString()]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 font-body",children:"※配送料は含まれていません"}),(0,s.jsx)(i.P.button,{className:"w-full bg-brand-gold text-white py-4 rounded-full font-display text-lg tracking-wide shadow-md disabled:opacity-60",whileHover:{y:u?0:-2},whileTap:{scale:u?1:.98},disabled:u,onClick:m,children:u?"処理中...":"ご注文手続きへ"}),h&&(0,s.jsx)("p",{className:"text-sm text-red-500 font-body text-center",children:h}),(0,s.jsx)(i.P.button,{onClick:t,className:"w-full border border-brand-gold text-brand-gold py-3 rounded-full font-display text-sm tracking-wide hover:bg-brand-gold hover:text-white transition-colors",whileTap:{scale:.98},children:"続けて買い物をする"})]})]})]})})}},5323:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>d,_:()=>u});var s=r(5155),n=r(2115);let l=e=>{let t=e.match(/[\d,]+/);return t?parseInt(t[0].replace(/,/g,""),10):0},i=e=>({totalItems:e.reduce((e,t)=>e+t.quantity,0),totalPrice:e.reduce((e,t)=>e+l(t.product.price)*t.quantity,0)}),a={items:[],isOpen:!1,totalItems:0,totalPrice:0},o=(e,t)=>{switch(t.type){case"ADD_ITEM":{let r,{product:s,quantity:n,color:l}=t.payload,a="".concat(s.id,"-").concat(l||"default"),o=e.items.findIndex(e=>e.id===a);if(o>=0)r=e.items.map((e,t)=>t===o?{...e,quantity:e.quantity+n}:e);else{let t={id:a,product:s,quantity:n,selectedColor:l,addedAt:Date.now()};r=[...e.items,t]}let{totalItems:c,totalPrice:d}=i(r);return{...e,items:r,totalItems:c,totalPrice:d}}case"REMOVE_ITEM":{let r=e.items.filter(e=>e.id!==t.payload.id),{totalItems:s,totalPrice:n}=i(r);return{...e,items:r,totalItems:s,totalPrice:n}}case"UPDATE_QUANTITY":{let{id:r,quantity:s}=t.payload;if(s<=0)return o(e,{type:"REMOVE_ITEM",payload:{id:r}});let n=e.items.map(e=>e.id===r?{...e,quantity:s}:e),{totalItems:l,totalPrice:a}=i(n);return{...e,items:n,totalItems:l,totalPrice:a}}case"CLEAR_CART":return{...e,items:[],totalItems:0,totalPrice:0};case"TOGGLE_CART":return{...e,isOpen:!e.isOpen};case"OPEN_CART":return{...e,isOpen:!0};case"CLOSE_CART":return{...e,isOpen:!1};case"LOAD_CART":{let{totalItems:r,totalPrice:s}=i(t.payload);return{...e,items:t.payload,totalItems:r,totalPrice:s}}default:return e}},c=(0,n.createContext)(void 0);function d(e){let{children:t}=e,[r,l]=(0,n.useReducer)(o,a);return(0,n.useEffect)(()=>{let e=sessionStorage.getItem("floral-lumina-cart");if(e)try{let t=JSON.parse(e);l({type:"LOAD_CART",payload:t})}catch(e){console.error("カートデータの読み込みに失敗しました:",e)}},[]),(0,n.useEffect)(()=>{sessionStorage.setItem("floral-lumina-cart",JSON.stringify(r.items))},[r.items]),(0,s.jsx)(c.Provider,{value:{state:r,addItem:(e,t,r)=>{l({type:"ADD_ITEM",payload:{product:e,quantity:t,color:r}})},removeItem:e=>{l({type:"REMOVE_ITEM",payload:{id:e}})},updateQuantity:(e,t)=>{l({type:"UPDATE_QUANTITY",payload:{id:e,quantity:t}})},clearCart:()=>{l({type:"CLEAR_CART"})},toggleCart:()=>{l({type:"TOGGLE_CART"})},openCart:()=>{l({type:"OPEN_CART"})},closeCart:()=>{l({type:"CLOSE_CART"})}},children:t})}function u(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e}},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},6654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return n}});let s=r(2115);function n(e,t){let r=(0,s.useRef)(null),n=(0,s.useRef)(null);return(0,s.useCallback)(s=>{if(null===s){let e=r.current;e&&(r.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(r.current=l(e,s)),t&&(n.current=l(t,s))},[e,t])}function l(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8110:e=>{e.exports={style:{fontFamily:"'Marcellus', 'Marcellus Fallback'",fontWeight:400,fontStyle:"normal"},className:"__className_0ccb75",variable:"__variable_0ccb75"}}},e=>{var t=t=>e(e.s=t);e.O(0,[532,191,63,911,441,684,358],()=>t(1493)),_N_E=e.O()}]);